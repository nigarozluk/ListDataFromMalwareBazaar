using Project.Core.Library.Functions;
using Project.Database.DAL;
using Project.Database.Entities;
using Project.Database.Repository.Abstract;
using Project.Database.ViewModel;
using System;
using System.Collections.Generic;
using System.Linq;
using System.Text;
using System.Threading.Tasks;

namespace Project.Database.Repository.Concrete.EntityFramework
{
   public class EFUserRepository: EFGenericRepository<User>, IUserRepository
    {
        private readonly ProjectContext projectContext;
        public EFUserRepository(ProjectContext context) : base(context)
        {
            projectContext = context;
        }

        public void DeleteCookie(int? userID)
        {
            User user = projectContext.Users.FirstOrDefault(x => x.Id == userID);
            user.RememberMe = "";
            Save();
        }

        public User GetUser(LoginViewModel entity)
        {
            var pass = PasswordHasher.PasswordHash(entity.Password);
            User data = projectContext.Users.FirstOrDefault(k => k.Email == entity.Email && k.Password == pass);
            return data;
        }

        public void UpdateCookie(string cookieValue, User user)
        {
            user.RememberMe = cookieValue;
            Save();
        }
    }
}
